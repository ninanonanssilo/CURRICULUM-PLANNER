<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>학년 교육과정 문서 생성기 | Edu Tools</title>
  <meta name="description" content="진도표/시수표 데이터를 업로드하면 학년 교육과정 문서(초안)를 자동으로 정리합니다." />
  <link rel="icon" href="/favicon.ico" sizes="any" />
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <div id="toast" class="toast" role="status" aria-live="polite" aria-atomic="true"></div>

  <aside id="sidebar" class="sidebar" aria-label="카테고리">
    <div class="sideHead">
      <a class="sideBrand" href="https://edu-tools.pages.dev/" target="_blank" rel="noreferrer" aria-label="Edu Tools로 이동">
        <span class="brandMark" aria-hidden="true">E</span>
        <span class="brandText">
          <span class="brandTitle">Edu Tools</span>
          <span class="brandSub">업무 자동화 도우미</span>
        </span>
      </a>
      <button id="navClose" class="iconBtn" type="button" aria-label="닫기">×</button>
    </div>
    <nav class="sideNav" aria-label="도구 목록">
      <div class="sideKicker">생성기</div>
      <a class="sideItem isActive" href="/" aria-current="page">학년 교육과정</a>
      <a class="sideItem" href="https://educate1.pages.dev/" target="_blank" rel="noreferrer">학교 공문 자동 작성 <span aria-hidden="true">↗</span></a>
      <a class="sideItem" href="https://money-report.pages.dev/" target="_blank" rel="noreferrer">품의 기안 생성기 <span aria-hidden="true">↗</span></a>
      <a class="sideItem" href="https://school-letter.pages.dev/" target="_blank" rel="noreferrer">가정통신문 생성기 <span aria-hidden="true">↗</span></a>
      <a class="sideItem" href="https://class-assignment.pages.dev/" target="_blank" rel="noreferrer">반편성 생성기 <span aria-hidden="true">↗</span></a>
    </nav>
    <div class="sideNote">같은 카테고리에서 Edu Tools 서비스를 이동할 수 있게 구성했습니다.</div>
  </aside>
  <div id="scrim" class="scrim" aria-hidden="true"></div>

  <header class="top">
    <div class="top-inner">
      <button id="navToggle" class="iconBtn" type="button" aria-label="카테고리 열기" aria-expanded="false">☰</button>

      <a class="brand" href="https://edu-tools.pages.dev/" target="_blank" rel="noreferrer">
        <span class="brandText">
          <span class="brandTitle">Edu Tools</span>
          <span class="brandSub">업무 자동화 도우미</span>
        </span>
      </a>

      <div class="hero">
        <h1 class="title">학년 교육과정 문서 자동 생성기</h1>
        <p class="subtitle">진도표/시수표를 한 번에 정리하고 결과를 내려받을 수 있게 도와줍니다.</p>
        <div class="privacy" role="note"><b>중요:</b> 업로드한 파일은 <b>서버로 전송/저장되지 않고</b> 이 브라우저에서만 처리됩니다.</div>
      </div>
    </div>
  </header>

  <main class="page">
    <section class="card">
      <details class="help" open>
        <summary>사용 안내 (권장 순서)</summary>
        <div class="helpSteps">
          <div>1) <b>기본 설정</b>: 학년도 → 학년군 → 학년을 선택합니다.</div>
          <div>2) <b>학사 일정</b>: 학기 시작일, 공휴일/대체공휴일/휴업일을 입력합니다.</div>
          <div>3) <b>총론 기반 편제</b>: 과목별 편제 시수를 입력합니다.</div>
          <div>4) <b>과목별 교육과정</b>: 성취기준/성취수준을 입력합니다.</div>
          <div>5) <b>원본 데이터</b>: 엑셀(xlsx) 업로드 후 시트를 선택합니다.</div>
          <div>6) <b>결과 확인/다운로드</b>: 시수 합계 + 연간 시간표를 확인하고 CSV/DOCX로 내려받습니다.</div>
        </div>
      </details>

      <div class="row" style="margin-top:12px;">
        <label class="field" style="max-width:180px;">
          <span class="label">1) 학년도</span>
          <input id="schoolYear" class="input" type="number" min="2000" max="2100" value="2026" />
          <div class="hint">문서 제목에 사용</div>
        </label>

        <label class="field" style="max-width:180px;">
          <span class="label">1) 학년군 선택</span>
          <select id="gradeBand" class="select">
            <option value="" selected>전체 학년군</option>
            <option value="1-2">1~2학년군</option>
            <option value="3-4">3~4학년군</option>
            <option value="5-6">5~6학년군</option>
          </select>
          <div class="hint">학년군을 먼저 고르면 학년 선택이 좁혀집니다.</div>
        </label>

        <label class="field" style="max-width:180px;">
          <span class="label">1) 학년 선택</span>
          <select id="gradeFilter" class="select">
            <option value="" selected>전체 학년</option>
            <option value="1">1학년</option>
            <option value="2">2학년</option>
            <option value="3">3학년</option>
            <option value="4">4학년</option>
            <option value="5">5학년</option>
            <option value="6">6학년</option>
          </select>
          <div class="hint">선택한 학년 데이터만 합산/다운로드</div>
        </label>

        <label class="field" style="flex:1;">
          <span class="label">5) 파일 업로드 (xlsx)</span>
          <input id="file" class="input" type="file" accept=".xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" />
          <div class="hint">업로드한 파일은 서버로 전송되지 않고 <b>브라우저에서만</b> 처리됩니다.</div>
        </label>

        <details class="help" style="max-width:300px; margin:0;">
          <summary>고급 옵션: 시수 범위 계산</summary>
          <div class="helpSteps" style="margin-top:8px;">
            <div>보통은 <b>건드리지 않아도 됩니다</b>. (기본: 평균)</div>
            <div>예: 시수가 "7-9"로 적혀 있으면</div>
            <div>- 평균: 8 / 최소: 7 / 최대: 9</div>
          </div>
          <label class="field" style="margin-top:8px; min-width:0;">
            <select id="rangePolicy" class="select">
              <option value="avg" selected>평균(7-9 → 8)</option>
              <option value="min">최소(7-9 → 7)</option>
              <option value="max">최대(7-9 → 9)</option>
            </select>
          </label>
        </details>
      </div>

      <label class="field" style="margin-top:10px;">
        <span class="label">1) 과목별 편제 시수 입력 (총론 기준, 선택)</span>
        <textarea id="subjectPlan" class="input" rows="4" placeholder="예:
국어: 120
수학: 136
사회: 68"></textarea>
        <div class="hint">형식: 한 줄에 "과목: 시수". 입력하면 합계표에 편제/차이가 함께 표시됩니다.</div>
      </label>

      <label class="field" style="margin-top:10px;">
        <span class="label">2) 과목별 교육과정 입력 (성취기준/성취수준, 선택)</span>
        <textarea id="subjectCurriculum" class="input" rows="5" placeholder="예:
국어 | 듣기·말하기 중심 성취기준 | 기본
수학 | 수와 연산 성취기준 | 심화
사회 | 지역 이해 성취기준 | 기본"></textarea>
        <div class="hint">형식: 한 줄에 "과목 | 성취기준(또는 핵심내용) | 성취수준"</div>
      </label>

      <div class="row" style="margin-top:10px; align-items:flex-end;">
        <label class="field" style="max-width:220px;">
          <span class="label">2) 학기 시작일</span>
          <input id="termStartDate" class="input" type="date" />
          <div class="hint">주차(1,2,3...)를 실제 날짜와 매핑할 기준일</div>
        </label>
        <label class="field" style="flex:1;">
          <span class="label">2) 학사 일정 입력 (학교별, 공휴일/대체공휴일 포함)</span>
          <textarea id="schoolSchedule" class="input" rows="4" placeholder="예:
2026-03-02,개학
2026-05-05,공휴일,어린이날
2026-05-06,대체공휴일
2026-10-02,재량휴업"></textarea>
          <div class="hint">형식: 날짜,유형,메모. 유형이 공휴일/대체공휴일/재량휴업/방학/시험이면 수업일에서 제외합니다.</div>
        </label>
      </div>

      <div class="row" style="margin-top:10px; align-items:flex-end;">
        <label class="field" style="flex:1;">
          <span class="label">5) 시트 선택</span>
          <select id="sheet" class="select" disabled>
            <option value="">파일을 먼저 업로드하세요</option>
          </select>
        </label>

        <div class="btns">
          <button id="btnTotals" class="btn" type="button" disabled>시수 합계 계산</button>
          <button id="btnCSV" class="btn ghost" type="button" disabled>CSV 다운로드</button>
          <button id="btnDocx" class="btn" type="button" disabled>DOCX 다운로드</button>
        </div>
      </div>

      <div id="status" class="status" role="status" aria-live="polite"></div>

      <details class="help" style="margin-top:10px;">
        <summary>입력 예시 (튜토리얼)</summary>
        <div class="helpSteps">
          <div><b>과목별 편제 시수</b><br/>국어: 120<br/>수학: 136<br/>사회: 68</div>
          <div><b>과목별 교육과정</b><br/>국어 | 듣기·말하기 성취기준 | 기본<br/>수학 | 수와 연산 성취기준 | 심화</div>
          <div><b>학사 일정</b><br/>2026-05-05,공휴일,어린이날<br/>2026-05-06,대체공휴일<br/>2026-10-02,재량휴업</div>
        </div>
      </details>
    </section>

    <section class="grid2">
      <section class="card">
        <div class="cardHead">
          <h2 class="h2">3) 교과별 시수 합계(결과)</h2>
          <div class="hint">교과별로 합계를 계산하고 편제 대비 차이를 확인합니다.</div>
        </div>
        <div class="tableWrap">
          <table class="table" aria-label="교과별 시수 합계">
            <thead>
              <tr>
                <th>교과</th>
                <th style="width:120px; text-align:right;">편제</th>
                <th style="width:120px; text-align:right;">합계</th>
                <th style="width:120px; text-align:right;">차이</th>
                <th style="width:120px; text-align:right;">행 개수</th>
              </tr>
            </thead>
            <tbody id="totalsBody">
              <tr><td colspan="5" class="muted">파일을 업로드하면 표시됩니다.</td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <section class="card">
        <div class="cardHead">
          <h2 class="h2">2) 과목별 교육과정 요약</h2>
          <div class="hint">입력한 성취기준/성취수준을 과목별로 정리합니다.</div>
        </div>
        <div class="tableWrap">
          <table class="table" aria-label="과목별 교육과정 요약">
            <thead>
              <tr>
                <th>과목</th>
                <th>성취기준(핵심내용)</th>
                <th style="width:120px;">성취수준</th>
              </tr>
            </thead>
            <tbody id="curriculumBody">
              <tr><td colspan="3" class="muted">과목별 교육과정 입력란을 채우면 표시됩니다.</td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </section>

    <section class="card" style="margin-top:14px;">
      <div class="cardHead">
        <h2 class="h2">3) 연간 시간표 (주차별)</h2>
        <div class="hint">선택한 학년(군) 기준으로 주차-과목별 시수를 집계하고, 학사 일정에 따라 수업가능일을 반영합니다.</div>
      </div>
      <div class="tableWrap" id="timetableWrap">
        <div class="muted">파일을 업로드하면 연간 시간표가 표시됩니다.</div>
      </div>
    </section>

    <section class="card" style="margin-top:14px;">
      <div class="cardHead">
        <h2 class="h2">학사 일정 요약</h2>
        <div class="hint">학교별 공휴일/대체공휴일/휴업일 입력 결과를 확인합니다.</div>
      </div>
      <div class="tableWrap">
        <table class="table" aria-label="학사 일정 요약">
          <thead><tr><th style="width:140px;">날짜</th><th style="width:180px;">유형</th><th>메모</th></tr></thead>
          <tbody id="scheduleBody"><tr><td colspan="3" class="muted">학사 일정을 입력하면 표시됩니다.</td></tr></tbody>
        </table>
      </div>
    </section>

    <section class="card" style="margin-top:14px;">
      <div class="cardHead">
        <h2 class="h2">원본 미리보기</h2>
        <div class="hint">인식된 헤더/데이터가 맞는지 확인하세요.</div>
      </div>
      <div class="tableWrap" id="previewWrap">
        <div class="muted">파일을 업로드하면 미리보기가 표시됩니다.</div>
      </div>
    </section>

    <footer class="footer">
      <div class="footerTitle">EDU TOOLS</div>
      <div class="footerCopy">교사용 업무 자동화 도구 모음</div>
    </footer>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.umd.js" defer></script>
  <script src="/main.js" defer></script>
</body>
</html>
